<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OVH Feedback Tracker - Analyst View</title>
    <link rel="stylesheet" href="/v2/css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-left">
            <div class="logo-container">
                <svg class="ovh-logo" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
                    <!-- OVHcloud Logo - Stylized O with wave -->
                    <circle cx="60" cy="60" r="55" fill="none" stroke="#123f6d" stroke-width="4"/>
                    <path d="M 35 60 Q 60 35, 85 60 Q 60 85, 35 60" fill="#123f6d"/>
                    <!-- Wave element -->
                    <path d="M 25 60 Q 35 50, 45 60 Q 55 70, 65 60 Q 75 50, 85 60 Q 95 70, 105 60" 
                          stroke="#00d4ff" stroke-width="3" fill="none" stroke-linecap="round"/>
                </svg>
                <span class="logo-text">OVHcloud Analyst View</span>
            </div>
            <h1 class="main-title">OVH Feedback Tracker</h1>
        </div>
        <div class="header-right">
            <div class="search-container">
                <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
                <input type="text" id="globalSearch" placeholder="Search by product, keyword, review, post, sources..." class="search-input">
                <div class="search-info-tooltip" id="searchInfoTooltip">
                    <svg class="info-icon-small" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 16v-4M12 8h.01"/>
                    </svg>
                    <div class="tooltip-content">
                        <strong>Recherche et filtres multiples</strong>
                        <p>‚Ä¢ La recherche fonctionne sur le contenu, l'auteur, l'URL et la source</p>
                        <p>‚Ä¢ Vous pouvez combiner plusieurs filtres : sentiment, langue, produit, dates</p>
                        <p>‚Ä¢ Les filtres s'appliquent simultan√©ment (ET logique)</p>
                        <p>‚Ä¢ Cliquez sur un produit dans "Distribution per Product" pour filtrer</p>
                    </div>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn-primary" id="scrapeAllBtn">üÜï Scrape New Data</button>
                <button class="btn-secondary" id="resetFiltersBtn">Reset Filters</button>
            </div>
        </div>
    </header>

    <!-- Main Dashboard -->
    <main class="dashboard-main">
        <!-- What's Happening Section -->
        <section class="panel-whats-happening">
            <div class="whats-happening-header">
                <h2>‚ö†Ô∏è What's Happening</h2>
                <div class="stats-cards" id="statsCards">
                    <!-- Will be populated by JS -->
                </div>
            </div>
            <div class="whats-happening-content" id="whatsHappeningContent">
                <!-- Will be populated by JS -->
            </div>
        </section>

        <!-- Left Panel: Timeline & Histogram -->
        <section class="panel-left">
            <div class="panel-header">
                <h2>Timeline & Histogram</h2>
                <div class="panel-filters">
                    <button class="filter-btn active" data-filter="all">All Posts</button>
                    <select class="filter-select" id="sentimentFilter">
                        <option value="all">All Sentiment</option>
                        <option value="positive">Positive</option>
                        <option value="negative">Negative</option>
                        <option value="neutral">Neutral</option>
                    </select>
                    <select class="filter-select" id="languageFilter">
                        <option value="all">All Language</option>
                        <option value="fr">Fran√ßais</option>
                        <option value="en">English</option>
                    </select>
                    <select class="filter-select" id="productFilter">
                        <option value="all">All Products</option>
                    </select>
                    <input type="date" id="dateFrom" class="filter-select" title="From Date" placeholder="From" style="min-width: 140px;">
                    <input type="date" id="dateTo" class="filter-select" title="To Date" placeholder="To" style="min-width: 140px;">
                </div>
            </div>
            <div class="chart-container">
                <canvas id="timelineChart"></canvas>
            </div>
        </section>

        <!-- Right Panel: Distribution by Product -->
        <section class="panel-right">
            <div class="panel-header">
                <h2>Distribution per Product</h2>
                <div class="panel-actions">
                    <span class="top-indicator">Top 5</span>
                    <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 16v-4M12 8h.01"/>
                    </svg>
                </div>
            </div>
            <div class="product-list" id="productList">
                <!-- Will be populated by JS -->
            </div>
            <div class="product-nav">
                <button class="nav-btn" id="showMoreProductsBtn">+ 12 Other Products</button>
                <div class="nav-arrows">
                    <button class="arrow-btn" id="navigateProductsPrevBtn">‚Üê</button>
                    <button class="arrow-btn" id="navigateProductsNextBtn">‚Üí</button>
                </div>
            </div>
        </section>

        <!-- Bottom Panel: Posts to Address -->
        <section class="panel-bottom">
            <div class="panel-header">
                <h2>Posts to Address (Recent & Critical)</h2>
                <div class="panel-actions">
                    <select class="sort-select" id="sortSelect">
                        <option value="recent">Most Recent</option>
                        <option value="critical">Most Critical</option>
                        <option value="engagement">Highest Engagement</option>
                    </select>
                    <svg class="sort-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 6h18M7 12h10M11 18h2"/>
                    </svg>
                </div>
            </div>
            <div class="posts-list" id="postsList">
                <!-- Will be populated by JS -->
            </div>
        </section>
    </main>

    <!-- Version Toggle Button -->
    <button class="version-toggle" id="versionToggleBtn" title="Switch UI Version">
        üîÑ V2
    </button>

    <!-- Theme Toggle -->
    <button class="theme-toggle" id="themeToggleBtn" title="Toggle Theme">
        üåì
    </button>

    <!-- Version Switch Modal -->
    <div id="versionModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <button id="closeVersionModalBtn" class="modal-close">√ó</button>
            <h2 style="color: var(--accent-primary); margin-bottom: 20px;">üîÑ Switch UI Version</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">
                Choose which version of the UI you want to use:
            </p>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button id="switchToV1Btn" class="version-btn" style="background: #00d4ff;">
                    üì± Version 1 (Classic)
                </button>
                <button id="switchToV2Btn" class="version-btn" style="background: #34d399;">
                    üöÄ Version 2 (Analyst View)
                </button>
            </div>
            <p style="color: var(--text-muted); font-size: 0.9em; margin-top: 20px; text-align: center;">
                The page will reload after switching.
            </p>
        </div>
    </div>

    <!-- Inline script to define functions immediately -->
    <script>
        // Define placeholder functions immediately to prevent errors
        window.openVersionModal = function() {
            console.log('openVersionModal called - waiting for module to load...');
        };
        window.closeVersionModal = function() {
            console.log('closeVersionModal called - waiting for module to load...');
        };
        window.switchToVersion = function(version) {
            console.log('switchToVersion called - waiting for module to load...', version);
        };
        window.toggleTheme = function() {
            console.log('toggleTheme called - waiting for module to load...');
        };
    </script>
    
    <!-- Modules -->
    <script type="module" src="/v2/js/api.js"></script>
    <script type="module" src="/v2/js/state.js"></script>
    <script type="module" src="/v2/js/dashboard.js"></script>
    <script type="module" src="/v2/js/charts.js"></script>
    <script type="module" src="/v2/js/version-switch.js"></script>
    <script type="module" src="/v2/js/app.js"></script>
</body>
</html>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Feedbacks Tracker - Analyst View</title>
    <link rel="stylesheet" href="/css/shared-theme.css">
    <link rel="stylesheet" href="/dashboard/css/styles.css">
    <link rel="stylesheet" href="/dashboard/css/navigation.css">
    <link rel="stylesheet" href="/css/modern-enhancements.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body class="has-nav-menu">
    <!-- Navigation Menu -->
    <nav class="nav-menu">
        <div class="nav-menu-left">
            <a href="/dashboard" class="nav-logo">
                <img src="" alt="OVHcloud" class="ovh-logo" style="width: 32px; height: 32px; object-fit: contain; display: none;" onerror="this.style.display='none';">
                <svg class="ovh-logo" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                    <circle cx="60" cy="60" r="55" fill="none" stroke="#123f6d" stroke-width="4"/>
                    <path d="M 35 60 Q 60 35, 85 60 Q 60 85, 35 60" fill="#123f6d"/>
                    <path d="M 25 60 Q 35 50, 45 60 Q 55 70, 65 60 Q 75 50, 85 60 Q 95 70, 105 60" 
                          stroke="#00d4ff" stroke-width="3" fill="none" stroke-linecap="round"/>
                </svg>
                <span>Customer Feedbacks Tracker</span>
            </a>
            <div class="nav-tabs">
                <a href="/dashboard" class="nav-tab active">
                    <span class="nav-tab-icon">üìä</span>
                    <span>Dashboard Analytics</span>
                </a>
                <a href="/improvements" class="nav-tab">
                    <span class="nav-tab-icon">üí°</span>
                    <span>Improvements Opportunities</span>
                </a>
                <a href="/scraping" class="nav-tab">
                    <span class="nav-tab-icon">üì•</span>
                    <span>Feedbacks Collection</span>
                </a>
                <a href="/logs" class="nav-tab">
                    <span class="nav-tab-icon">üìã</span>
                    <span>Scraping Logs</span>
                </a>
                <a href="/settings" class="nav-tab">
                    <span class="nav-tab-icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                </a>
                <a href="#" class="nav-tab" onclick="event.preventDefault(); toggleHelpMenu(); return false;">
                    <span class="nav-tab-icon">‚ùì</span>
                    <span>Help</span>
                </a>
            </div>
        </div>
        <div class="nav-menu-right">
            <!-- Scraping Actions -->
            <button class="btn-scrape-compact" id="scrapeAllBtn" title="Scrape new data from all sources">
                üÜï Scrape
            </button>
            <button class="btn-cancel-scraping-compact" id="cancelScrapingBtn" style="display: none; padding: 4px 12px; font-size: 0.85em; background: #ef4444; color: white; border: 1px solid #dc2626; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; white-space: nowrap;" onclick="cancelScraping()" title="Cancel current scraping job">
                ‚ùå Cancel
            </button>
            <span class="beta-badge" title="Application en version beta">BETA</span>
            <span class="version-badge" id="versionBadge" title="Application version">v1.0.1</span>
            <button class="theme-toggle" id="themeToggleBtn" title="Toggle theme">üåì</button>
        </div>
    </nav>

    <!-- Main Dashboard -->
    <main class="dashboard-main">
        <!-- Search Section with KPI and Report Generator -->
        <section class="search-section-with-kpi" style="grid-column: 1 / 3;">
            <div class="search-kpi-container">
                <!-- Left: KPI Satisfaction -->
                <div class="kpi-card-left">
                    <div class="kpi-icon">üòä</div>
                    <div class="kpi-content">
                        <div class="kpi-label" id="positiveSatisfactionLabel">Positive Satisfaction</div>
                        <div class="kpi-value" id="positiveSatisfactionValue">--%</div>
                    </div>
                </div>
                
                <!-- Center: Search Bar -->
                <div class="search-wrapper-center">
                    <div class="search-container-prominent" style="position: relative;">
                        <svg class="search-icon-large" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                        <input type="text" id="globalSearch" placeholder="Search by product, keyword, review, post, source..." class="search-input-prominent" autofocus>
                        <!-- Reset Filters Button (contextual, appears when filters are active) -->
                        <button class="btn-reset-filters-inline" id="resetFiltersBtn" style="display: none; position: absolute; right: 50px; top: 50%; transform: translateY(-50%); background: transparent; border: none; color: var(--text-secondary); cursor: pointer; padding: 4px 8px; border-radius: 4px; transition: all 0.2s ease;" title="Reset all filters" onmouseover="this.style.color='var(--accent-primary)'; this.style.background='rgba(0,212,255,0.1)';" onmouseout="this.style.color='var(--text-secondary)'; this.style.background='transparent';">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                <line x1="18" y1="6" x2="6" y2="18"/>
                                <line x1="6" y1="6" x2="18" y2="18"/>
                            </svg>
                        </button>
                        <div class="search-info-tooltip" id="searchInfoTooltip">
                            <svg class="info-icon-small" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4M12 8h.01"/>
                            </svg>
                            <div class="tooltip-content">
                                <strong>üí° Quick Tips</strong>
                                <p>Searches content, author, URL & source ‚Ä¢ Filters combine automatically</p>
                            </div>
                        </div>
                    </div>
                    <p class="search-hint" style="font-size: 0.85em; color: var(--text-muted); margin: 8px 0 0 0; text-align: center;">
                        üí° Search across all feedback content, or use filters below to narrow down results
                    </p>
                    <!-- Go to Posts Button -->
                    <button class="btn-go-to-posts" id="goToPostsBtn" title="Voir tous les posts avec filtres" style="margin-top: 16px; width: 100%; max-width: 300px;">
                        üìã Go to Posts
                    </button>
                </div>
                
                <!-- Right: Report Generator -->
                <div class="report-generator-card-right">
                    <div class="report-generator-header">
                        <svg class="report-icon-header" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14 2 14 8 20 8"/>
                        </svg>
                        <span class="report-title">Generate Report</span>
                    </div>
                    <button class="btn-generate-report" id="generateReportBtn" title="Generate PowerPoint report with key insights">
                        <span class="btn-text">üìä PowerPoint</span>
                        <span class="btn-spinner" style="display:none;"></span>
                    </button>
                    <p class="report-hint">4 charts + Key takeaways + AI analysis</p>
                </div>
            </div>
            
            <!-- Scraping Progress Bar -->
            <div id="scrapingProgressContainer" style="display: none; margin-top: 20px;" data-status="running" data-percentage="0%">
                <div style="display: flex; align-items: center; justify-content: space-between; gap: 16px; margin-bottom: 12px; flex-wrap: wrap;">
                    <span id="scrapingProgressText" style="flex: 1; min-width: 0;">Initializing scraping job...</span>
                    <button class="btn-cancel-scraping-progress" id="cancelScrapingProgressBtn" style="display: none; padding: 8px 18px; font-size: 0.9em; background: #ef4444; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; flex-shrink: 0; white-space: nowrap;" onclick="cancelScraping()" title="Cancel current scraping job" onmouseover="this.style.background='#dc2626';" onmouseout="this.style.background='#ef4444';">
                        ‚ùå Cancel
                    </button>
                </div>
                <div>
                    <div id="scrapingProgressBar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>
        </section>
        <!-- Posts Statistics Section -->
        <section class="panel-posts-overview" style="grid-column: 1 / 3;">
            <div class="posts-overview-header">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                    <h2 style="margin: 0;">üìä Posts Statistics</h2>
                    <!-- Critical Posts Badge (appears when there are critical posts) -->
                    <button class="critical-posts-badge" id="openCriticalPostsBtn" style="display: none; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; border: none; border-radius: 20px; padding: 8px 16px; font-size: 0.9em; font-weight: 600; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3); display: inline-flex; align-items: center; gap: 6px;" title="Afficher les posts n√©gatifs des 7 derniers jours" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(239, 68, 68, 0.5)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(239, 68, 68, 0.3)';">
                        ‚ö†Ô∏è Critical Posts: <span id="criticalPostsCount" style="font-weight: 700; display: inline-block; vertical-align: baseline;">0</span>
                    </button>
                </div>
                <div class="posts-overview-content">
                    <div class="stats-cards" id="statsCards">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
                <!-- Date Range integrated in Posts Statistics -->
                <div class="date-slicer-inline" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                    <div class="date-slicer-group">
                        <label class="date-label-compact">
                            <svg class="date-icon-compact" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                <line x1="16" y1="2" x2="16" y2="6"/>
                                <line x1="8" y1="2" x2="8" y2="6"/>
                                <line x1="3" y1="10" x2="21" y2="10"/>
                            </svg>
                            <span class="date-label-text">Date Range</span>
                        </label>
                        <div class="date-inputs-compact">
                            <input type="date" id="globalDateFrom" class="date-input-compact" title="From Date">
                            <span class="date-separator-compact">‚Üí</span>
                            <input type="date" id="globalDateTo" class="date-input-compact" title="To Date">
                            <button class="btn-clear-dates-compact" id="clearDatesBtn" title="Clear dates">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                    <line x1="18" y1="6" x2="6" y2="18"/>
                                    <line x1="6" y1="6" x2="18" y2="18"/>
                                </svg>
                            </button>
                        </div>
                        <span id="globalDefaultDateRangeIndicator" style="font-size: 0.75rem; color: var(--text-secondary); font-style: italic; margin-left: 8px; white-space: nowrap;" title="Default range: last 12 months">
                            (12 derniers mois par d√©faut)
                        </span>
                    </div>
                    <button class="btn-clear-all-compact" id="clearAllFiltersBtn" title="Clear all filters">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                        <span>Clear All</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- What's Happening Section -->
        <section class="panel-whats-happening" style="grid-column: 1 / 3;">
            <div class="whats-happening-header">
                <h2>‚ö†Ô∏è What's Happening</h2>
            </div>
            <div class="whats-happening-content" id="whatsHappeningContent">
                <!-- Will be populated by JS -->
            </div>
            <div class="recommended-actions" id="recommendedActions">
                <!-- Will be populated by JS -->
            </div>
        </section>

        <!-- Analytics Section -->
        <section class="panel-analytics" style="grid-column: 1 / 3;">
            <div class="analytics-header">
                <h2>üìà Analytics</h2>
            </div>
            <div class="analytics-content">
                <!-- Left Panel: Timeline -->
                <section class="panel-left">
                    <div class="panel-header">
                        <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                            <h2>Timeline</h2>
                            <select id="timelineViewMode" style="padding: 4px 8px; border-radius: 4px; border: 1px solid var(--border-color); font-size: 0.85em; background: var(--bg-secondary); color: var(--text-primary); cursor: pointer;" title="Select timeline view mode">
                                <option value="day">By Day</option>
                                <option value="week">By Week</option>
                                <option value="month" selected>By Month</option>
                            </select>
                        </div>
                        <div class="panel-filters">
                            <button class="filter-btn active" data-filter="all">All Posts</button>
                            <select class="filter-select" id="sentimentFilter">
                                <option value="all">All Sentiment</option>
                                <option value="positive">Positive</option>
                                <option value="negative">Negative</option>
                                <option value="neutral">Neutral</option>
                            </select>
                            <select class="filter-select" id="languageFilter">
                                <option value="all">All Language</option>
                                <option value="fr">Fran√ßais</option>
                                <option value="en">English</option>
                            </select>
                            <select class="filter-select" id="productFilter">
                                <option value="all">All Products</option>
                            </select>
                            <input type="date" id="dateFrom" class="filter-select" title="From Date" placeholder="From" style="min-width: 140px;">
                            <input type="date" id="dateTo" class="filter-select" title="To Date" placeholder="To" style="min-width: 140px;">
                            <button id="clearTimelineFilterBtn" class="filter-btn" style="background: #ef4444; color: white; margin-left: 8px;" title="Reset timeline to default (last 12 months)">Clear Filter</button>
                        </div>
                    </div>
                    <div class="chart-container" title="Hover over bars to see details. Click to filter by date. Drag to select a date range.">
                        <canvas id="timelineChart"></canvas>
                    </div>
                </section>

                <!-- Right Panel: Distribution by Product -->
                <section class="panel-right">
                    <div class="panel-header">
                        <h2>Distribution per Product</h2>
                        <div class="panel-actions">
                            <span class="top-indicator">Top 5</span>
                            <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4M12 8h.01"/>
                            </svg>
                        </div>
                    </div>
                    <div class="product-list" id="productList">
                        <!-- Will be populated by JS -->
                    </div>
                    <div class="product-nav">
                        <button class="nav-btn" id="showMoreProductsBtn">+ 12 Other Products</button>
                        <div class="nav-arrows">
                            <button class="arrow-btn" id="navigateProductsPrevBtn">‚Üê</button>
                            <button class="arrow-btn" id="navigateProductsNextBtn">‚Üí</button>
                        </div>
                    </div>
                </section>

                <!-- Posts by Source Panel -->
                <section class="panel-source">
                    <div class="panel-header">
                        <h2>üìä Posts by Source</h2>
                        <div class="panel-actions">
                            <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4M12 8h.01"/>
                            </svg>
                        </div>
                    </div>
                    <div class="chart-container-source">
                        <canvas id="sourceChart"></canvas>
                    </div>
                </section>

                <!-- Sentiment Distribution Panel -->
                <section class="panel-sentiment">
                    <div class="panel-header">
                        <h2>üí≠ Sentiment Distribution</h2>
                        <div class="panel-actions">
                            <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4M12 8h.01"/>
                            </svg>
                        </div>
                    </div>
                    <div class="chart-container-sentiment">
                        <canvas id="sentimentChart"></canvas>
                    </div>
                </section>
            </div>
        </section>

        <!-- World Map Panel (Hidden by default, can be toggled) -->
        <section class="panel-map" style="display: none;">
            <div class="panel-header">
                <h2>üåç Posts by Country</h2>
                <div class="panel-actions">
                    <div class="map-legend" id="mapLegend">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>
            <div class="map-container" id="worldMap">
                <!-- Leaflet map will be rendered here -->
            </div>
        </section>

        <!-- Posts Section with Filters -->
        <section id="postsSection" class="panel-posts-section" style="grid-column: 1 / 3;">
            <div class="posts-section-header">
                <h2>üìã All Posts</h2>
                <div class="posts-filters-container">
                    <div class="sort-controls" style="display: flex; gap: 12px; align-items: center; justify-content: center; margin-bottom: 20px;">
                        <label for="postsSortBy" style="color: var(--text-secondary); font-weight: 500; font-size: 0.95em;">Sort by:</label>
                        <div style="position: relative; display: inline-block;">
                            <select id="postsSortBy" onchange="updatePostsDisplay()" 
                                    style="padding: 10px 30px 10px 15px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-card); color: var(--text-primary); font-size: 0.95em; cursor: pointer; appearance: none; -webkit-appearance: none; -moz-appearance: none; transition: all 0.2s ease; min-width: 200px;"
                                    onmouseover="this.style.borderColor='var(--accent-primary)'; this.style.boxShadow='0 2px 8px rgba(0, 212, 255, 0.2)';"
                                    onmouseout="this.style.borderColor='var(--border-color)'; this.style.boxShadow='none';"
                                    onfocus="this.style.borderColor='var(--accent-primary)'; this.style.boxShadow='0 0 0 3px rgba(0, 212, 255, 0.3)'; this.style.outline='none';"
                                    onblur="this.style.borderColor='var(--border-color)'; this.style.boxShadow='none';">
                                <option value="date-desc">üìÖ Date (Newest)</option>
                                <option value="date-asc">üìÖ Date (Oldest)</option>
                                <option value="sentiment-desc">üò° Sentiment (Negative First)</option>
                                <option value="sentiment-asc">üòä Sentiment (Positive First)</option>
                                <option value="relevancy-desc">‚≠ê Relevancy (Highest First)</option>
                                <option value="relevancy-asc">‚≠ê Relevancy (Lowest First)</option>
                                <option value="source-asc">üìä Source (A-Z)</option>
                                <option value="source-desc">üìä Source (Z-A)</option>
                            </select>
                            <svg style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); pointer-events: none; width: 16px; height: 16px; fill: var(--text-secondary);" viewBox="0 0 24 24">
                                <path d="M7 10l5 5 5-5z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="posts-filters-row" style="display: flex; gap: 12px; flex-wrap: wrap; justify-content: center; margin-bottom: 20px;">
                        <select id="postsSentimentFilter" onchange="updatePostsDisplay()" class="filter-select" style="min-width: 150px;">
                            <option value="all">All Sentiment</option>
                            <option value="positive">Positive</option>
                            <option value="negative">Negative</option>
                            <option value="neutral">Neutral</option>
                        </select>
                        <select id="postsSourceFilter" onchange="updatePostsDisplay()" class="filter-select" style="min-width: 150px;">
                            <option value="all">All Sources</option>
                        </select>
                        <select id="postsLanguageFilter" onchange="updatePostsDisplay()" class="filter-select" style="min-width: 150px;">
                            <option value="all">All Languages</option>
                            <option value="fr">Fran√ßais</option>
                            <option value="en">English</option>
                        </select>
                        <input type="date" id="postsDateFrom" onchange="updatePostsDisplay()" class="filter-select" title="From Date" placeholder="From" style="min-width: 140px;">
                        <input type="date" id="postsDateTo" onchange="updatePostsDisplay()" class="filter-select" title="To Date" placeholder="To" style="min-width: 140px;">
                        <button onclick="clearPostsFilters()" class="filter-btn" style="background: #ef4444; color: white;">Clear Filters</button>
                    </div>
                </div>
            </div>
            <div id="postsGallery" class="gallery">
                <!-- Will be populated by JS -->
            </div>
            <div id="postsPagination" style="text-align: center; margin-top: 20px; padding: 20px;">
                <!-- Pagination controls -->
            </div>
        </section>
    </main>


    <!-- Post Preview Modal -->
    <div id="postPreviewModal" class="modal-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 10002; overflow-y: auto; background: rgba(0, 0, 0, 0.7);">
        <div class="modal-content" style="max-width: 800px; margin: 50px auto; padding: 30px; background: var(--bg-primary); border-radius: 12px; position: relative; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);">
            <button onclick="closePostPreviewModal()" style="position: absolute; top: 20px; right: 20px; background: #ef4444; border: none; border-radius: 50%; width: 40px; height: 40px; color: var(--text-primary); font-size: 1.5em; cursor: pointer; font-weight: bold; line-height: 1;">√ó</button>
            <h2 style="color: var(--accent-primary); margin-bottom: 25px; text-align: center; font-size: 1.8em;">üëÅÔ∏è Post Preview</h2>
            <div id="postPreviewContent" style="color: var(--text-primary); line-height: 1.8;">
                <!-- Content will be inserted here -->
            </div>
            <div style="text-align: center; margin-top: 25px;">
                <a id="postPreviewLink" href="#" target="_blank" style="padding: 10px 20px; background: var(--accent-primary); color: #1a1a2e; text-decoration: none; border-radius: 8px; font-weight: bold; display: inline-block;">üîó Open Original Post</a>
            </div>
        </div>
    </div>

    <!-- Version Switch Modal -->
    <div id="versionModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <button id="closeVersionModalBtn" class="modal-close">√ó</button>
            <h2 style="color: var(--accent-primary); margin-bottom: 20px;">üîÑ Switch UI Version</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">
                Choose which version of the UI you want to use:
            </p>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button id="switchToV1Btn" class="version-btn" style="background: #00d4ff;">
                    üì± Version 1 (Classic)
                </button>
                <button id="switchToV2Btn" class="version-btn" style="background: #34d399;">
                    üöÄ Version 2 (Analyst View)
                </button>
            </div>
            <p style="color: var(--text-muted); font-size: 0.9em; margin-top: 20px; text-align: center;">
                The page will reload after switching.
            </p>
        </div>
    </div>

    <!-- Inline script to define functions immediately -->
    <script>
        // Define placeholder functions immediately to prevent errors
        window.openVersionModal = function() {
            console.log('openVersionModal called - waiting for module to load...');
        };
        window.closeVersionModal = function() {
            console.log('closeVersionModal called - waiting for module to load...');
        };
        window.switchToVersion = function(version) {
            console.log('switchToVersion called - waiting for module to load...', version);
        };
        window.toggleTheme = function() {
            console.log('toggleTheme called - waiting for module to load...');
        };
        window.toggleHelpMenu = function() {
            const menu = document.getElementById('helpMenu');
            if (menu) {
                menu.classList.toggle('active');
            }
        };
    </script>
    
    <!-- Help Menu -->
    <div class="help-menu" id="helpMenu">
        <div class="help-menu-header">
            <h2>üìñ Help & Information</h2>
            <button class="help-menu-close" onclick="toggleHelpMenu()">√ó</button>
        </div>
        <div class="help-menu-content">
            <h3>üí¨ Customer Feedbacks Tracker</h3>
            <p>
                <strong>Dashboard Analytics</strong> provides visual insights and real-time analysis of customer feedback across all OVH products and services.
            </p>

                <h3>üìä Dashboard Sections</h3>
                <ul>
                    <li><strong>üìà Statistics Banner:</strong> Overview of total posts, positive, negative, and neutral feedback</li>
                    <li><strong>‚ö†Ô∏è What's Happening:</strong> Real-time alerts, insights, and AI-generated recommended actions</li>
                    <li><strong>üìÖ Timeline:</strong> Visual timeline of feedback over time with interactive filtering</li>
                    <li><strong>üìä Distribution per Product:</strong> Breakdown of feedback by OVH product category</li>
                    <li><strong>üìù Priority Posts:</strong> Critical and recent posts requiring attention</li>
                </ul>

                <h3>üéØ Interactive Features</h3>
                <ul>
                    <li><strong>Timeline Click:</strong> Click on a bar to filter posts by that date</li>
                    <li><strong>Timeline Double-Click:</strong> Double-click a bar to filter by date AND the most frequent product for that date</li>
                    <li><strong>Product Click:</strong> Click on a product in "Distribution per Product" to filter all posts by that product</li>
                    <li><strong>Clear Filters:</strong> Use the "Clear Product Filter" button or reset filters to remove active filters</li>
                    <li><strong>Critical Posts:</strong> Click "Open critical posts (X)" to view negative posts from the last 7 days, sorted by score (most negative) and date (most recent)</li>
                </ul>

                <h3>üîç Filtering Options</h3>
                <ul>
                    <li><strong>Global Search:</strong> Search across all post content (supports multiple keywords separated by spaces)</li>
                    <li><strong>Sentiment Filter:</strong> Filter by positive, negative, or neutral sentiment</li>
                    <li><strong>Language Filter:</strong> Filter by French, English, or other languages</li>
                    <li><strong>Product Filter:</strong> Filter by specific OVH product categories</li>
                    <li><strong>Date Range:</strong> Use timeline interaction or date inputs to filter by date</li>
                    <li><strong>Sort Options:</strong> Sort posts by date, sentiment, or source</li>
                </ul>

                <h3>ü§ñ AI-Powered Features</h3>
                <p>
                    If LLM API keys are configured (in Feedbacks Collection page):
                </p>
                <ul>
                    <li><strong>Recommended Actions:</strong> AI-generated actionable recommendations based on recent feedback patterns</li>
                    <li><strong>Priority Levels:</strong> Actions are prioritized as High, Medium, or Low based on impact</li>
                    <li><strong>Dynamic Insights:</strong> Real-time analysis of feedback trends and spikes</li>
                </ul>

                <h3>üìä What's Happening Section</h3>
                <ul>
                    <li><strong>Alerts:</strong> Automatic detection of negative feedback spikes (230%+ increase)</li>
                    <li><strong>Insights:</strong> Identification of top impacted products and most frequent issues</li>
                    <li><strong>Recommended Actions:</strong> AI-generated or rule-based improvement suggestions</li>
                    <li><strong>Critical Posts Button:</strong> Quick access to view negative posts from the last 7 days, sorted by sentiment score (highest first) and date (most recent first)</li>
                </ul>

                <h3>üìà Charts & Visualizations</h3>
                <ul>
                    <li><strong>Timeline Chart:</strong> Bar chart showing post distribution over time</li>
                    <li><strong>Product Distribution:</strong> Pie/bar chart showing feedback distribution across products</li>
                    <li><strong>Interactive Tooltips:</strong> Hover over chart elements for detailed information</li>
                    <li><strong>Show More Products:</strong> Expand to see all products beyond the top 5</li>
                </ul>

                <h3>üé® Navigation</h3>
                <ul>
                    <li><strong>üì• Feedbacks Collection:</strong> Manage keywords, LLM settings, and launch scrapers</li>
                    <li><strong>üìä Dashboard Analytics:</strong> Current page - visual analytics and insights</li>
                    <li><strong>üí° Improvements Opportunities:</strong> Pain points analysis and opportunity scoring</li>
                    <li><strong>‚ùì Help:</strong> This menu - access help and documentation</li>
                    <li><strong>üåì Theme Toggle:</strong> Switch between light and dark mode</li>
                </ul>

                <h3>üîç Recherche et Filtres</h3>
                <ul>
                    <li><strong>Barre de recherche centrale :</strong> Recherchez par produit, mot-cl√©, avis, post ou source</li>
                    <li><strong>Filtres multiples :</strong> Combinez sentiment, langue, produit et dates pour une analyse pr√©cise</li>
                    <li><strong>Timeline interactive :</strong> Cliquez ou glissez-d√©posez pour filtrer par p√©riode</li>
                    <li><strong>Distribution par produit :</strong> Cliquez sur un produit pour filtrer automatiquement</li>
                </ul>

                <h3>üí° Pro Tips</h3>
                <ul>
                    <li>Utilisez la timeline pour identifier les tendances et pics de feedback</li>
                    <li>Configurez les cl√©s LLM pour d√©bloquer les actions recommand√©es par IA</li>
                    <li>Le bouton "Critical Posts" affiche les posts n√©gatifs des 7 derniers jours, tri√©s par score (plus n√©gatif) et date (plus r√©cent)</li>
                    <li>Les filtres s'appliquent simultan√©ment (logique ET)</li>
                    <li>Explorez les opportunit√©s d'am√©lioration dans la page d√©di√©e</li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- Modules -->
    <script src="/js/logo-updater.js"></script>
    <script type="module" src="/dashboard/js/api.js"></script>
    <script type="module" src="/dashboard/js/state.js"></script>
    <!-- Filtered Posts Drawer -->
    <div id="filteredPostsDrawer" class="filtered-posts-drawer">
        <div class="drawer-backdrop" onclick="closeFilteredPostsDrawer()"></div>
        <div class="drawer-panel">
            <div id="filteredPostsDrawerContent" class="drawer-content">
                <!-- Content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <script type="module" src="/dashboard/js/version-loader.js"></script>
    <script type="module" src="/dashboard/js/dashboard.js"></script>
    <script type="module" src="/dashboard/js/charts.js?v=2.0"></script>
    <script type="module" src="/dashboard/js/world-map.js?v=2.0"></script>
    <script type="module" src="/dashboard/js/version-switch.js?v=2.0"></script>
    <script type="module" src="/dashboard/js/app.js?v=2.0"></script>
    <script>
        // Close help menu when clicking outside
        document.addEventListener('click', (e) => {
            const helpMenu = document.getElementById('helpMenu');
            const helpTab = document.querySelector('.nav-tab[onclick*="toggleHelpMenu"]');
            if (helpMenu && helpTab && 
                !helpMenu.contains(e.target) && 
                !helpTab.contains(e.target) &&
                helpMenu.classList.contains('active')) {
                helpMenu.classList.remove('active');
            }
        });
    </script>
    
    <!-- Back to Search Button (floating) -->
    <div id="backToSearchBtn" style="display: none; position: fixed; bottom: 24px; right: 24px; z-index: 9999; padding: 12px 20px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); color: white; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 16px rgba(0, 153, 255, 0.4); transition: all 0.3s ease;" onclick="scrollToSearch()">
        üîç Back to Search
    </div>
</body>
</html>

